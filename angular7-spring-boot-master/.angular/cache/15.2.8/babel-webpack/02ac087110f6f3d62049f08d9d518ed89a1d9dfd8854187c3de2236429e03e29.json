{"ast":null,"code":"var _a;\nimport { __decorate, __metadata } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { DecimalPipe } from '@angular/common';\nimport { map, startWith } from 'rxjs/operators';\nimport { DataService } from '../../../service/data.service';\nimport { HttpCourierService } from '../../../service/courier/http-courier.service';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { CommentDialogComponent } from '../../../helpers/comment-dialog/comment-dialog.component';\n// tslint:disable-next-line:prefer-const\nlet courierPackages;\nconst statusType = 'получена';\nconst statusTypeProblem = 'Проблем с пратката';\nfunction search(text, pipe) {\n  return courierPackages.filter(packages => {\n    const term = text.toLowerCase();\n    // @ts-ignore\n    return packages.name_package.toLowerCase().includes(term) || packages.customer.name.toLowerCase().includes(term) || packages.customer.phone.toLowerCase().includes(term);\n  });\n}\nlet ListPackagesComponent = class ListPackagesComponent {\n  // tslint:disable-next-line:max-line-length\n  constructor(pipe, dataService, httpCourier, modalService) {\n    this.dataService = dataService;\n    this.httpCourier = httpCourier;\n    this.modalService = modalService;\n    this.filter = new FormControl('');\n    this.username = sessionStorage.getItem('username');\n    console.log(this.username);\n    this.httpCourier.getPackages(this.username).subscribe(data => {\n      // @ts-ignore\n      courierPackages = [...data];\n      // tslint:disable-next-line:only-arrow-functions\n      this.packages$ = this.filter.valueChanges.pipe(startWith(''), map(text => search(text, pipe)));\n    });\n  }\n  ngOnInit() {}\n  updatePackage(packages) {\n    console.log(packages.package_id);\n    if (packages.package_id != null && statusType != null) {\n      // @ts-ignore\n      this.httpCourier.updatePackageSuccessfull(statusType, packages.package_id).subscribe(data => {\n        // tslint:disable-next-line:triple-equals\n        // @ts-ignore\n        alert('Пратката е доставена успешно!');\n      });\n    }\n  }\n  updateProblemPackage(packages) {\n    const dialogRef = this.modalService.open(CommentDialogComponent);\n    dialogRef.result.then(result => {\n      if (result.event === true) {\n        this.dataService.packagesId = packages.package_id;\n        this.httpCourier.updateProblemPackage(statusTypeProblem, packages.package_id, result.data, result.file).subscribe(data => {\n          alert('Проблемът на пратката е регистриран успешно!');\n        });\n        console.log('dada' + result.data); // Refresh Data in table grid\n      } else {}\n    }, reason => {});\n    console.log(dialogRef.result);\n  }\n};\nListPackagesComponent = __decorate([Component({\n  selector: 'app-list-packages',\n  templateUrl: './list-packages.component.html',\n  styleUrls: ['./list-packages.component.css']\n}), __metadata(\"design:paramtypes\", [DecimalPipe, DataService, HttpCourierService, typeof (_a = typeof NgbModal !== \"undefined\" && NgbModal) === \"function\" ? _a : Object])], ListPackagesComponent);\nexport { ListPackagesComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}