{"ast":null,"code":"var _a;\nimport { __decorate, __metadata } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { DecimalPipe } from '@angular/common';\nimport { DataService } from '../../../service/data.service';\nimport { HttpCourierService } from '../../../service/courier/http-courier.service';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { map, startWith } from 'rxjs/operators';\nimport { FormControl } from '@angular/forms';\nlet courierPackages;\nconst statusType = 'получена';\nfunction search(text, pipe) {\n  return courierPackages.filter(packageProblem => {\n    const term = text.toLowerCase();\n    // @ts-ignore\n    return packageProblem.packages_problem.name_package.toLowerCase().includes(term) || packageProblem.packages_problem.customer.name.toLowerCase().includes(term) || packageProblem.packages_problem.customer.phone.toLowerCase().includes(term);\n  });\n}\nlet ProblemPackagesComponent = class ProblemPackagesComponent {\n  // tslint:disable-next-line:max-line-length\n  constructor(pipe, dataService, httpCourier, modalService) {\n    this.dataService = dataService;\n    this.httpCourier = httpCourier;\n    this.modalService = modalService;\n    this.filter = new FormControl('');\n    this.username = sessionStorage.getItem('username');\n    console.log(this.username);\n    this.httpCourier.getProblemPackages(this.username).subscribe(data => {\n      // @ts-ignore\n      courierPackages = [...data];\n      console.log(courierPackages);\n      this.packages$ = this.filter.valueChanges.pipe(startWith(''), map(text => search(text, pipe)));\n    });\n  }\n  ngOnInit() {}\n  updatePackage(packages) {\n    if (packages.packages_problem.package_id != null && statusType != null) {\n      // @ts-ignore\n      this.httpCourier.updatePackageSuccessfull(statusType, packages.package_id).subscribe(data => {\n        // tslint:disable-next-line:triple-equals\n        // @ts-ignore\n        alert('Пратката е доставена успешно!');\n      });\n    }\n  }\n};\nProblemPackagesComponent = __decorate([Component({\n  selector: 'app-problem-packages',\n  templateUrl: './problem-packages.component.html',\n  styleUrls: ['./problem-packages.component.css']\n}), __metadata(\"design:paramtypes\", [DecimalPipe, DataService, HttpCourierService, typeof (_a = typeof NgbModal !== \"undefined\" && NgbModal) === \"function\" ? _a : Object])], ProblemPackagesComponent);\nexport { ProblemPackagesComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}