{"ast":null,"code":"import _defineProperty from \"E:/Programs/SpringAngularProject/angular7-springboot-crud-tutorial-master/update-version/angular7-spring-boot-master/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { PipeTransform } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { HttpAdiministratorService } from '../../../../service/administrator/http-adiministrator.service';\nimport { DataService } from '../../../../service/data.service';\nimport { FormControl } from '@angular/forms';\nimport { DecimalPipe } from '@angular/common';\nimport { map, startWith } from 'rxjs/operators';\nimport { Observable } from 'rxjs';\nimport { ConfirmDialogService } from '../../../../service/confirm-dialog.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../../service/administrator/http-adiministrator.service\";\nimport * as i3 from \"../../../../service/data.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../../../service/confirm-dialog.service\";\nimport * as i6 from \"../../../../headers/header-layout-adiministrator/header-layout-adiministrator.component\";\nimport * as i7 from \"@angular/material/sidenav\";\nimport * as i8 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i9 from \"@angular/forms\";\nfunction ListUsersComponent_tr_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 12);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵelement(4, \"ngb-highlight\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵelement(6, \"ngb-highlight\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵelement(8, \"ngb-highlight\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵelement(10, \"ngb-highlight\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵelement(12, \"ngb-highlight\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(13, \"td\");\n    i0.ɵɵelementStart(14, \"td\")(15, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function ListUsersComponent_tr_32_Template_button_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const user_r1 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.deleteUser(user_r1));\n    });\n    i0.ɵɵtext(16, \"\\u0418\\u0437\\u0442\\u0440\\u0438\\u0439\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function ListUsersComponent_tr_32_Template_button_click_17_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const user_r1 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.editUser(user_r1));\n    });\n    i0.ɵɵtext(18, \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u0430\\u0439\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const user_r1 = ctx.$implicit;\n    const i_r2 = ctx.index;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r2 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"result\", user_r1.name)(\"term\", ctx_r0.filter.value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"result\", user_r1.last_name)(\"term\", ctx_r0.filter.value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"result\", user_r1.phone)(\"term\", ctx_r0.filter.value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"result\", user_r1.city)(\"term\", ctx_r0.filter.value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"result\", user_r1.address)(\"term\", ctx_r0.filter.value);\n  }\n}\n// @ts-ignore\nlet users;\n// tslint:disable-next-line:label-position no-unused-expression\nfunction search(text, pipe) {\n  return users.filter(user => {\n    console.log(user);\n    const term = text.toLowerCase();\n    return user.name.toLowerCase().includes(term) || user.last_name.toLowerCase().includes(term) || user.phone.toLowerCase().includes(term);\n  });\n}\nexport let ListUsersComponent = /*#__PURE__*/(() => {\n  class ListUsersComponent {\n    // tslint:disable-next-line:max-line-length\n    constructor(router, apiService, dataService, pipe, confirmService) {\n      _defineProperty(this, \"router\", void 0);\n      _defineProperty(this, \"apiService\", void 0);\n      _defineProperty(this, \"dataService\", void 0);\n      _defineProperty(this, \"pipe\", void 0);\n      _defineProperty(this, \"confirmService\", void 0);\n      _defineProperty(this, \"filter\", new FormControl(''));\n      // users: Customer[];\n      _defineProperty(this, \"result$\", void 0);\n      this.router = router;\n      this.apiService = apiService;\n      this.dataService = dataService;\n      this.pipe = pipe;\n      this.confirmService = confirmService;\n      this.apiService.getUsers().subscribe(data => {\n        // @ts-ignore\n        users = [...data];\n        console.log(users);\n        // this.users = data;\n        this.result$ = this.filter.valueChanges.pipe(startWith(''), map(text => search(text, pipe)));\n      });\n    }\n    ngOnInit() {\n      /*if (!window.localStorage.getItem('token')) {\r\n        this.router.navigate(['login']);\r\n        return;\r\n      }\r\n       this.apiService.getUsers()\r\n        .subscribe( data => {\r\n           this.users = data;\r\n        }); */\n    }\n    deleteUser(customer) {\n      console.log(customer.user_id);\n      this.confirmService.confirm('Моля потвърдете', 'Искате ли да изтриете този потребител ?').then(confirmed => {\n        // tslint:disable-next-line:triple-equals\n        if (confirmed != false) {\n          this.apiService.deleteUser(customer.user_id).subscribe(data => {\n            users = users.filter(u => u !== customer);\n            window.location.reload();\n          });\n        }\n      }).catch(() => console.log('User dismissed the dialog (e.g., by using ESC, clicking the cross icon, or clicking outside the dialog)'));\n      /* this.apiService.deleteUser(customer.user_account.username, customer.phone).subscribe( data => {\r\n        users = users.filter(u => u !== customer);\r\n      }); */\n      /* this.apiService.deleteUser(2)\r\n         .subscribe( data => {\r\n           this.users = this.users.filter(u => u !== customer);\r\n         }); */\n    }\n\n    editUser(customer) {\n      // window.localStorage.removeItem('editUserId');\n      // window.localStorage.setItem('editUserId', customer.toString());\n      this.dataService.customer = customer;\n      this.router.navigate(['/administrator/edit-user']);\n    }\n    addUser() {\n      this.router.navigate(['/administrator/add-user']);\n    }\n  }\n  _defineProperty(ListUsersComponent, \"\\u0275fac\", function ListUsersComponent_Factory(t) {\n    return new (t || ListUsersComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpAdiministratorService), i0.ɵɵdirectiveInject(i3.DataService), i0.ɵɵdirectiveInject(i4.DecimalPipe), i0.ɵɵdirectiveInject(i5.ConfirmDialogService));\n  });\n  _defineProperty(ListUsersComponent, \"\\u0275cmp\", /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ListUsersComponent,\n    selectors: [[\"app-list-users\"]],\n    decls: 34,\n    vars: 4,\n    consts: [[1, \"example-container\"], [1, \"search\"], [1, \"mb-3\", \"row\"], [\"for\", \"table-filtering-search\", 1, \"col-xs-3\", \"col-sm-auto\", \"col-form-label\"], [1, \"col-xs-3\", \"col-sm-auto\"], [\"id\", \"table-filtering-search\", \"type\", \"text\", 1, \"form-control\", 3, \"formControl\"], [1, \"col-md-7\", \"user-container\"], [2, \"margin\", \"auto\"], [1, \"btn\", \"btn-info\", 3, \"click\"], [1, \"table\", \"table-striped\"], [1, \"hidden\"], [4, \"ngFor\", \"ngForOf\"], [\"scope\", \"row\"], [3, \"result\", \"term\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"btn\", \"btn-success\", 2, \"margin-left\", \"20px\", 3, \"click\"]],\n    template: function ListUsersComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-header-layout-adiministrator\");\n        i0.ɵɵelementStart(1, \"mat-sidenav-container\", 0)(2, \"mat-sidenav-content\");\n        i0.ɵɵelement(3, \"br\");\n        i0.ɵɵelementStart(4, \"form\", 1)(5, \"div\", 2)(6, \"label\", 3);\n        i0.ɵɵtext(7, \"\\u0422\\u044A\\u0440\\u0441\\u0435\\u043D\\u0435 \\u043D\\u0430 \\u043A\\u043B\\u0438\\u0435\\u043D\\u0442(\\u043F\\u043E \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0435\\u043D \\u043D\\u043E\\u043C\\u0435\\u0440):\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 4);\n        i0.ɵɵelement(9, \"input\", 5);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(10, \"div\", 6)(11, \"h2\", 7);\n        i0.ɵɵtext(12, \"\\u0418\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u044F \\u0437\\u0430 \\u043F\\u043E\\u0442\\u0440\\u0435\\u0431\\u0438\\u0442\\u0435\\u043B\\u0438\\u0442\\u0435\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"br\");\n        i0.ɵɵelementStart(14, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function ListUsersComponent_Template_button_click_14_listener() {\n          return ctx.addUser();\n        });\n        i0.ɵɵtext(15, \"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438 \\u043F\\u043E\\u0442\\u0440\\u0435\\u0431\\u0438\\u0442\\u0435\\u043B\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"table\", 9)(17, \"thead\")(18, \"tr\")(19, \"th\", 10);\n        i0.ɵɵtext(20, \"#\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"th\");\n        i0.ɵɵtext(22, \"\\u0418\\u043C\\u0435\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"th\");\n        i0.ɵɵtext(24, \"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"th\");\n        i0.ɵɵtext(26, \"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"th\");\n        i0.ɵɵtext(28, \"\\u0413\\u0440\\u0430\\u0434\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"th\");\n        i0.ɵɵtext(30, \"\\u0410\\u0434\\u0440\\u0435\\u0441\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(31, \"tbody\");\n        i0.ɵɵtemplate(32, ListUsersComponent_tr_32_Template, 19, 11, \"tr\", 11);\n        i0.ɵɵpipe(33, \"async\");\n        i0.ɵɵelementEnd()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"formControl\", ctx.filter);\n        i0.ɵɵadvance(23);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(33, 2, ctx.result$));\n      }\n    },\n    dependencies: [i4.NgForOf, i6.HeaderLayoutAdiministratorComponent, i7.MatSidenavContainer, i7.MatSidenavContent, i8.NgbHighlight, i9.ɵNgNoValidate, i9.DefaultValueAccessor, i9.NgControlStatus, i9.NgControlStatusGroup, i9.NgForm, i9.FormControlDirective, i4.AsyncPipe],\n    styles: [\".search[_ngcontent-%COMP%]{margin-left:16px}\"]\n  }));\n  return ListUsersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}